%global __jar_repack 0
Name: ovirt-engine-wildfly
Version: @VERSION@
Release: 1%{?dist}
Summary: WildFly Application Server for oVirt Engine
Group: Virtualization/Management
License: ASL 2.0
URL: http://jbossas.jboss.org
Source: @SRC@

BuildRequires: unzip
BuildRequires: chrpath

# Prevent breaking packages that require e.g. libapr-1.so
AutoReqProv: no

%description
WildFly Application Server for oVirt Engine.

%install
mkdir -p %{buildroot}%{_datadir}
unzip -d %{buildroot}%{_datadir} %{SOURCE0}
mv %{buildroot}%{_datadir}/wildfly-%{version}.Final %{buildroot}%{_datadir}/%{name}

%ifarch x86_64
chrpath --delete %{buildroot}%{_datadir}/%{name}/modules/system/layers/base/org/hornetq/main/lib/linux-x86_64/libHornetQAIO64.so
rm -rf %{buildroot}%{_datadir}/%{name}/modules/system/layers/base/org/hornetq/main/lib/linux-i686
%endif

%ifarch %{ix86}
chrpath --delete %{buildroot}%{_datadir}/%{name}/modules/system/layers/base/org/hornetq/main/lib/linux-i686/libHornetQAIO32.so
rm -rf %{buildroot}%{_datadir}/%{name}/modules/org/jboss/as/web/main/lib/linux-x86_64
%endif

%files
%{_datadir}

%changelog
* Thu Oct 22 2015 Martin Perina <mperina@redhat.com> - 8.2.1-1
- Update to upstream version 8.2.1.

* Tue Feb 17 2015 Juan Hernandez <juan.hernandez@redhat.com> - 8.2.0-1
- Update to upstream version 8.2.0.

* Thu Jul 17 2014 Juan Hernandez <juan.hernandez@redhat.com> - 8.1.0-1
- Initial release based on existing jboss-as spec file.
